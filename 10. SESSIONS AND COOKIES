<?php
session_start();

// --- Handle Logout ---
if (isset($_POST['logout'])) {
    session_destroy();
    setcookie("user", "", time() - 3600, "/"); // clear cookie
    header("Location: " . $_SERVER['PHP_SELF']); // reload page
    exit;
}

// --- Handle Login ---
if (isset($_POST['login'])) {
    $username = $_POST['username'];

    // store in session
    $_SESSION['username'] = $username;

    // if remember me is checked, store in cookie for 1 hour
    if (isset($_POST['remember'])) {
        setcookie("user", $username, time() + 3600, "/");
    }
}

// --- Check if already logged in ---
$sessionUser = $_SESSION['username'] ?? null;
$cookieUser  = $_COOKIE['user'] ?? null;
?>
<!DOCTYPE html>
<html>
<head>
    <title>Session & Cookie Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .box {
            background: #fff;
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0px 4px 8px rgba(0,0,0,0.2);
            width: 320px;
            text-align: center;
        }
        h2 { color: #2c3e50; }
        input {
            padding: 8px;
            margin: 8px 0;
            width: 90%;
            border: 1px solid #ccc;
            border-radius: 6px;
        }
        button {
            background: #3498db;
            color: #fff;
            border: none;
            padding: 10px 20px;
            margin-top: 10px;
            border-radius: 6px;
            cursor: pointer;
        }
        button:hover { background: #217dbb; }
    </style>
</head>
<body>
<div class="box">
    <?php if ($sessionUser): ?>
        <h2>Welcome, <?= htmlspecialchars($sessionUser) ?> ðŸ‘‹</h2>
        <p><b>Session Value:</b> <?= htmlspecialchars($sessionUser) ?></p>
        <p><b>Cookie Value:</b> <?= $cookieUser ? htmlspecialchars($cookieUser) : "Not set" ?></p>
        <form method="post">
            <button name="logout">Logout</button>
        </form>
    <?php else: ?>
        <h2>Login</h2>
        <form method="post">
            <input type="text" name="username" placeholder="Enter username" required><br>
            <label><input type="checkbox" name="remember"> Remember me (cookie)</label><br>
            <button name="login">Login</button>
        </form>
    <?php endif; ?>
</div>
</body>
</html>
